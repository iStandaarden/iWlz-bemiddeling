""" 
  Graphql Schemadefinitie voor het Bemiddelingregister
  Versie 0.0.1
  Gebaseerd op ERD versie 20220928 en gegevensmatrix versie 20220928
"""
scalar UUID
scalar Date

schema {
  query: Query
}

"de volgende bevragingen zijn er gedefinieerd"
type Query {
  # Haal alle bemiddelingen voor bsn
  getWlzBemiddelingVoorBsn(bsn: String!): [WlzBemiddeling!]
  # Haal WlzBemiddeling op voor BemiddelingID
  getWlzBemiddelingVoorBemiddelingID(bemiddelingID:UUID!): WlzBemiddeling!
  # Haal Contacten op voor bsn
  getContactVoorBsn(bsn: String!): [Contact!]
}

"Objects"
type WlzBemiddeling {
  bemiddelingID: UUID!
  bsn: String!
  partnerOpname: String! #COD260: Ja of nee - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/tree/main/codelijsten/COD260
  besluitnummer: Int!
  verantwoordelijkZorgkantoor: String! #COD001: Zorgkantoor - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/blob/main/codelijsten/COD001
  ingangsdatum: Date
  einddatum: Date
  instelling: [Instelling]
  pgb: [Pgb]
} 

type Instelling {
  agbCodeInstelling: String! 
  uitvoerendZorgkantoor: String! #COD001: Zorgkantoor - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/blob/main/codelijsten/COD001
  teLeverenZorgInNatura: [TeLeverenZorgInNatura!]
}

type TeLeverenZorgInNatura {
  leveringsvorm: String! #COD578: Leveringsvorm - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/blob/main/codelijsten/COD578
  zzpCode: String! #COD163: Zorgzwaartepakket - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/blob/main/codelijsten/COD163
  toewijzingIngangsdatum: Date!
  zinSpecificatie: [ZinSpecificatie!]
}

type ZinSpecificatie {
  vaststellingsDatumTijd
  toewijzingEinddatum: Date
  toewijzingPercentage: Int!
  opname: String! #COD260: Ja of nee - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/tree/main/codelijsten/COD260
  redenIntrekking: 
  etmalen: 
  instellingBestemming: String!
  soortToewijzing: String! #COD165: Soort toewijzing - https://github.com/iStandaarden/iWlz-codelijsten-APiWlz/blob/main/codelijsten/COD165
  soortMachtiging: 

}

"""
type Wlzbemiddeling {
    bemiddelingID: UUID!
    bsn: String!
    statusBemiddeling: String! #De status van de bemiddeling
    leveringsvorm: String #Gecodeerde aanduiding van de vorm waarin zorg binnen de Wlz geleverd kan worden
    ontvangstdatum: Date! #De datum waarop het verzoek tot bemiddeling is ontvangen
    ingangsdatum: Date #De datum waarop het zorgkantoor start met bemiddelen
    einddatum: Date #De datum waarop het zorgkantoor de bemiddeling heeft afgerond
    overdrachtsdatum: Date #De datum vanaf wanneer het nieuwe zorgkantoor verantwoordelijk is
    zorgkantoorOverdracht: String #Verantwoordelijk zorgkantoor vanaf dossieroverdracht (Moet voldoen aan COD001: Zorgkantoor; zie iWlz codelijsten)
    zorgaanbieders: [Zorgaanbieder]
    pgb: [Pgb]
}

type Pgb {
    status: String! #Status pgb
    bedragBgb: integer
    ingangsdatum: Date
    einddatum: Date
}


    WlzbemiddelingID:
      type: string
      format: uuid
      pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$'
      xml:
        name: wlzbemiddelingID
    WlzbemiddelingIDs:
      type: array
      items:
        $ref: '#/components/schemas/WlzbemiddelingID'
      xml:
        name: wlzbemiddelingIDs
        wrapped: true
    Zorgaanbieder:
      required:
        - zorgaanbieder
        - ingangsdatum
      type: object
      properties:
        Zorgaanbieder:
          description: "De zorgaanbieder waarnaar de cliÃ«nt bemiddeld is (volgens iWlz-agbcodelijst)"
          type: string
          pattern: '^[0-9]{8}$'
        Ingangsdatum:
          description: "De datum die aangeeft vanaf welke datum de client naar de instelling bemiddeld is"
          type: string
          format: date
        Opname:
          description: "Aanduiding waarmee wordt aangegeven of zorgaanbieder het opnamedeel, binnen leveringsvorm (deeltijd)verblijf, levert"
          type: boolean
      xml:
        name: zorgaanbieder
    Zorgaanbieders:
      type: array
      items:
        $ref: '#/components/schemas/Zorgaanbieder'
      xml:
        name: zorgaanbieders
        wrapped: true

"""